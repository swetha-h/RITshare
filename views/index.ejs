<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
			crossorigin="anonymous"
		/>
		
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"
		/>
		
		<link rel="stylesheet" href="stylesheets/main.css" />
		<title>RITshare</title>
	
	</head>
	<body>
	
		<!--navbar-->
		<nav class="navbar navbar-expand-lg bg-black navbar-dark position-sticky">
			<div class="container-fluid">
				<a href="#" class="navbar-brand">RITshare</a>
				
				<!-- <ul class="navbar-nav">
					<li class="nav-item">
						<a href="#clubs" class="nav-link">Clubs</a>
					</li>
				</ul>
				<ul class="navbar-nav">
					<li class="nav-item">
						<a href="#events" class="nav-link">Events</a>
					</li>
				</ul> -->
			
          
            <!--checkout bootstrap modal to get the popup once any button is clicked without using any js-->
                 
				<ul class="navbar-nav ms-auto">
					<li class="nav-item">
						<button
							type="button"
							id = "btn1"
							style="margin:5px"
							class="btn btn-dark"
							data-bs-toggle="modal"
							data-bs-target="#login"
						>
							Login
						</button>
					</li>
                   <br/>
					<li class="nav-item">
						<button
						    style="margin:5px"
							type="button"
							id = "btn2"
							class="btn btn-dark"
							data-bs-toggle="modal"
							data-bs-target="#signup"
						>
							Signup
						</button>
					</li>
				</ul>

		
        </div>        
    </nav>
    <!--banner-->
    <section class="bg-dark text-light p-5 text-center">
        <div class="container-fluid">
            <div class="d-sm-flex align-items-center justify-content-between">
                <div>
                    <h1><span class="text-primary">Explore</span> events of RIT!</h1>
                    <p class="lead my-4"><!--lead class is to make the font bigger my is for spacing-->
                        Have fun exploring all the events of our very own Ramaiah Institute Of Technology.
						Login to know more!
                    </p>
                </div>
                <img class="img-fluid w-50 ms-auto" src="images/team_collaboration.svg" alt="team">
            </div>
        </div>
    </section>
    <!--boxes-->
    
    <!-- Modal -->
    <!--Clubs-->
    <section class="p-5" id="clubs">
        <div class="container">
            <div class="row align-items-center justify-content-between">
                <div class="col-md">
                    <img class="img-fluid h-50" src="images/community.svg" alt="">
                </div>
                <div class="col-md p-5">
                    <h2>Explore the clubs</h2>
                    <p class="lead">
                        Lorem ipsum, dolor sit amet consectetur adipisicing elit.
                         Ut quas praesentium alias inventore aspernatur at.
                         Lorem ipsum dolor sit amet. 
                    </p>
                    <!-- <a href="/clubs" class="btn btn-light mt-4">
                        <i class="bi bi-chevron-right">Check out</i>
                    </a> -->
                </div>
            </div>
        </div>
    </section>

    <!--events-->

    <section class="p-5 bg-dark text-light" id="events">
        <div class="container">
            <div class="row align-items-center justify-content-between">
                <div class="col-md p-5">
                    <h2>Explore the Events</h2>
                    <p class="lead">
                        Lorem ipsum, dolor sit amet consectetur adipisicing elit.
                         Ut quas praesentium alias inventore aspernatur at.
                         Lorem ipsum dolor sit amet. 
                    </p>
                    <!-- <a href="/events" class="btn btn-light mt-4">
                        <i class="bi bi-chevron-right">Check out</i>
                    </a> -->
                </div>
                <div class="col-md">
                    <img src="images/festivities.svg" class="img-fluid" alt="">
                </div>
            </div>
            
        </div>
    </section>
    <!--footer-->
    <footer class="p-5 bg-black sh text-white text-center align-items-center">
        <div class="container">
            <p>CopyRight &copy; 2021 DBS</p>
        </div>
    </footer>
    


		<!-- Modal for login -->
		<div
			class="modal fade"
            data-bs-backdrop="static" 
			data-bs-keyboard="false"
			id="login"
			tabindex="-1"
			role="dialog"
			aria-labelledby="loginLabel"
			aria-hidden="true"
			
		>
			<div class="modal-dialog" >
				<div class="modal-content">
	
				
					<div class="modal-body">

                       <h2 class="modal-title" align= "center" id="loginLabel" style="margin-top: 6%;
	margin-bottom: 2%; color: #2c0253; " >RITshare</h2>

	<h4 class="modal-title" align= "center" id="loginh"  style="
	margin-bottom: 6%;  ">Login</h4>
						<form id="login">
				
								<input
								    class="form"
									type="text"
					
									autocomplete="off"
									id="usn"
									placeholder="USN"
								/>
						
						</br>
							
								<input
									type="password"
								     class="form"
									autocomplete="off"
									id="password"
									placeholder="Password"
								/>
						

							
							 <button  class="forgot" 
							  type="button"
						
							style="background:none; border:none;  margin-left: 35%;margin-bottom: 2%;
						"
							data-bs-toggle="modal"
							data-bs-target="#forgot-password"
							
							  >Forgot password?</button>
					</br>
							    
							    <div style="text-align: center;">
    <span id="error">
       
    </span>
</div>
						
								<input class= "submit "type="submit" value="Login" />
							  <button  class="forgot" 
							  type="button"
						
							style="background:none; border:none;  margin-left: 25%;
							margin-bottom: 10%;"
							  	data-bs-toggle="modal"
							data-bs-target="#signup"
							  >Don't have an account. SignUp?</button>
					
                           </br>

						</form>
					</div>
				
				</div>
				<script>
					
					const form = document.getElementById('login');
					form.addEventListener('submit', login);

					async function login(event) {
						event.preventDefault();
						const usn = document.getElementById('usn').value;
						const password = document.getElementById('password').value;
						const result = await fetch('/api/login', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({
								username:usn,
								password
							})
						}).then((res) => res.json());

						if (result.status === 'ok') {
							// window.location.replace('/loggedin');
							window.location.href = "/loggedin" +"?usn="+ usn;
							console.log('Got the token: ', result.data);
							token = result.data;
							localStorage.setItem('token', result.data);
							console.log('Success');
						} else {
							// alert(result.error);
							error.textContent = result.error;
            error.style.color = "red"
						}
					}	
				</script>
			</div>
		</div>


		<!-- Modal for signup -->
		<div
			class="modal fade"
			id="signup"
			data-bs-backdrop="static" 
			data-bs-keyboard="false"
			tabindex="-1"
			aria-labelledby="loginLabel"
			aria-hidden="true"
			
		>
			<div class="modal-dialog">
				<div class="modal-content">
				
					<div class="modal-body">

                      <h2 class="modal-title" align= "center" id="loginLabel" style="margin-top: 6%;
	margin-bottom: 2%; color: #2c0253; " >RITshare</h2>

	<h4 class="modal-title" align= "center" id="loginh"  style="
	margin-bottom: 6%;  ">Signup</h4>
						<form id="reg-form">
			
			<input
				type="text"
				class="form"
				autocomplete="off"
				id="username"
				placeholder="USN"
			/>

			<input
				type="password"
				class="form"
				autocomplete="off"
				id="password1"
				placeholder="Password"
			/>

				</br>
							    
							    <div style="text-align: center;">
    <span id="error1">
       
    </span>
</div>
</br>

			<input type="submit" class="submit1" value="Signup" />
		</form>
					</div>
				
				</div>

					<script>
			const form1 = document.getElementById('reg-form');
			form1.addEventListener('submit', registerUser);

			async function registerUser(event) {
				event.preventDefault();
				const username = document.getElementById('username').value;
				const password = document.getElementById('password1').value;

				const result = await fetch('/api/register', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						username,
						password
					})
				}).then((res) => res.json());

				if (result.status === 'ok') {
					// window.location.replace('/');
					window.location.href = "/loggedin" +"?usn="+ usn;
					console.log('Success');
				} else {
					error1.textContent = result.error;
            error1.style.color = "red"
				}
			}
		</script>
			
			</div>
		</div>

		
		<!-- Modal for forgot-password -->
		<div
			class="modal fade"
			id="forgot-password"
			tabindex="-1"
			aria-labelledby="loginLabel"
			aria-hidden="true"
			data-bs-backdrop="static" 
			data-bs-keyboard="false"
			
		>
			<div class="modal-dialog">
				<div class="modal-content">
				
					<div class="modal-body">

                       <h2 class="modal-title" align= "center" id="loginLabel" style="margin-top: 6%;
	margin-bottom: 2%; color: #2c0253; " >RITshare</h2>

	<h4 class="modal-title" align= "center" id="loginh"  style="
	margin-bottom: 6%;  ">Change your password.</h4>
	</br>
						<form id="forgot-password">
			<input
			class="form"
				type="password"
				autocomplete="off"
				id="password2"
				placeholder="Password"
			/>
				</br>
				<div style="text-align: center;">		    
			 <button  class="forgot" 
							  type="button"
							  id = "error2"
						
							style="background:none; border:none; text-decoration: underline ;  
						"
							data-bs-toggle="modal"
							data-bs-target="#login"
							
							  ></button></div>	
			  
			<input type="submit" class="submit1" value="Change Password"  />
	         
		</form>

				
					<script>
			const form2 = document.getElementById('forgot-password');
			form2.addEventListener('submit', registerUser);

			async function registerUser(event) {
				event.preventDefault();
				const password2 = document.getElementById('password2').value;

				const result = await fetch('/api/change-password', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						newpassword: password2,
						token: localStorage.getItem('token')
					})
				}).then((res) => res.json());

				if (result.status === 'ok') {
					console.log('Success');
					error.textContent= "";
					error2.textContent= "Password Changed! Login";
					 error2.style.color = "green"
				
					
				} else {
					error.textContent= "";
					error2.textContent = result.error;
            error2.style.color = "red"
			
				}
			}

		</script>
			
			</div>
		</div>


		
	
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
     integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" 
     crossorigin="anonymous">

    $('#myCarousel').carousel({
    interval: 5000
    })
    </script>
    <script>

    document.getElementById("addEvent").onclick = function() {
        document.getElementById("addEvent").style.display = "none";
    }
</script>
	</body>
</html>
